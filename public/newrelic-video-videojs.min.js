/*!
 * @license MIT
 * newrelic-video-videojs 0.3.1
 * Copyright New Relic <http://newrelic.com/>
 * @author Jordi Aguilar
 */
!function (e, t) { "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == typeof exports ? exports.nrvideo = t() : e.nrvideo = t() }(this, function () { return function (e) { function t(n) { if (i[n]) return i[n].exports; var r = i[n] = { i: n, l: !1, exports: {} }; return e[n].call(r.exports, r, r.exports, t), r.l = !0, r.exports } var i = {}; return t.m = e, t.c = i, t.d = function (e, i, n) { t.o(e, i) || Object.defineProperty(e, i, { configurable: !1, enumerable: !0, get: n }) }, t.n = function (e) { var i = e && e.__esModule ? function () { return e.default } : function () { return e }; return t.d(i, "a", i), i }, t.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, t.p = "", t(t.s = 9) }([function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.version = t.Core = t.VideoTrackerState = t.VideoTracker = t.Tracker = t.Emitter = t.Log = t.Chrono = t.Constants = void 0; var r = i(10), a = n(r), s = i(11), o = n(s), u = i(3), l = n(u), d = i(2), c = n(d), h = i(4), f = n(h), y = i(5), p = n(y), v = i(12), g = n(v), k = i(7), m = n(k), E = i(6); t.Constants = o.default, t.Chrono = l.default, t.Log = c.default, t.Emitter = f.default, t.Tracker = p.default, t.VideoTracker = g.default, t.VideoTrackerState = m.default, t.Core = a.default, t.version = E.version }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function r(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function a(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) } Object.defineProperty(t, "__esModule", { value: !0 }); var s = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), o = i(0), u = function (e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]); return t.default = e, t }(o), l = i(8), d = function (e) { function t() { return n(this, t), r(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments)) } return a(t, e), s(t, [{ key: "getTrackerName", value: function () { return "videojs-ads" } }, { key: "getTrackerVersion", value: function () { return l.version } }, { key: "isMuted", value: function () { return this.player.muted() } }, { key: "getRenditionHeight", value: function () { return null } }, { key: "getRenditionWidth", value: function () { return null } }, { key: "getPlayerName", value: function () { return "videojs-ads" } }, { key: "getPlayerVersion", value: function () { return this.player.ads.VERSION } }, { key: "registerListeners", value: function () { u.Log.debugCommonVideoEvents(this.player, [null, "ads-request", "ads-load", "adstart", "adend", "adskip", "adserror", "ads-click", "ads-pod-started", "ads-pod-ended", "ads-first-quartile", "ads-midpoint", "ads-third-quartile", "ads-pause", "ads-play", "adtimeout"]), this.player.on("ads-request", this.onAdrequest.bind(this)), this.player.on("ads-load", this.onAdload.bind(this)), this.player.on("adstart", this.onAdstart.bind(this)), this.player.on("adend", this.onAdend.bind(this)), this.player.on("adskip", this.onAdskip.bind(this)), this.player.on("adserror", this.onAdserror.bind(this)), this.player.on("ads-click", this.onAdsClick.bind(this)), this.player.on("ads-pod-started", this.onPodStart.bind(this)), this.player.on("ads-pod-ended", this.onPodEnd.bind(this)), this.player.on("ads-first-quartile", this.onFirstQuartile.bind(this)), this.player.on("ads-midpoint", this.onMidpoint.bind(this)), this.player.on("ads-third-quartile", this.onThirdQuartile.bind(this)), this.player.on("ads-pause", this.onAdspause.bind(this)), this.player.on("ads-play", this.onAdsplay.bind(this)) } }, { key: "unregisterListeners", value: function () { this.player.off("ads-request", this.onAdrequest), this.player.off("ads-load", this.onAdload), this.player.off("adstart", this.onAdstart), this.player.off("adend", this.onAdend), this.player.off("adskip", this.onAdskip), this.player.off("adserror", this.onAdserror), this.player.off("ads-click", this.onAdsClick), this.player.off("ads-pod-started", this.onPodStart), this.player.off("ads-pod-ended", this.onPodEnd), this.player.off("ads-first-quartile", this.onFirstQuartile), this.player.off("ads-midpoint", this.onMidpoint), this.player.off("ads-third-quartile", this.onThirdQuartile), this.player.off("ads-pause", this.onAdspause), this.player.off("ads-play", this.onAdsplay) } }, { key: "onAdrequest", value: function (e) { this.sendRequest(), this.sendDownload({ state: "ads-request" }) } }, { key: "onAdload", value: function (e) { this.sendDownload({ state: "ads-load" }) } }, { key: "onAdstart", value: function (e) { this.sendRequest(), this.sendStart() } }, { key: "onAdend", value: function (e) { this.sendEnd() } }, { key: "onAdskip", value: function (e) { this.sendEnd({ skipped: !0 }) } }, { key: "onAdserror", value: function (e) { this.sendError() } }, { key: "onAdsClick", value: function (e) { this.sendAdClick({ url: "unknown" }) } }, { key: "onPodStart", value: function (e) { this.sendAdBreakStart() } }, { key: "onPodEnd", value: function (e) { this.sendAdBreakEnd() } }, { key: "onFirstQuartile", value: function () { this.sendAdQuartile({ quartile: 1 }) } }, { key: "onMidpoint", value: function () { this.sendAdQuartile({ quartile: 2 }) } }, { key: "onThirdQuartile", value: function () { this.sendAdQuartile({ quartile: 3 }) } }, { key: "onAdspause", value: function () { this.sendPause() } }, { key: "onAdsplay", value: function () { this.sendResume() } }]), t }(u.VideoTracker); t.default = d }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function r(e, t, i) { t = t || l.Levels.NOTICE, i = i || "darkcyan"; var n = l.prefix; if (l.includeTime && (n += a() + " "), n += o(t) + ":", l.level <= t && t !== l.Levels.SILENT) if (!l.colorful || "undefined" != typeof document && document.documentMode) s(e, n); else { var r; r = t === l.Levels.ERROR && console.error ? console.error : t === l.Levels.WARNING && console.warn ? console.warn : t === l.Levels.DEBUG && console.debug ? console.debug : console.log, n = "%c" + n, e.splice(0, 0, n, "color: " + i), r.apply(console, e) } } function a() { var e = new Date; return "[" + ("0" + e.getDate()).slice(-2) + ":" + ("0" + e.getMinutes()).slice(-2) + ":" + ("0" + e.getSeconds()).slice(-2) + "." + ("00" + e.getMilliseconds()).slice(-3) + "]" } function s(e, t) { if (e instanceof Array) for (var i in e) s(e[i], t); else "string" == typeof e ? console.log(t + " " + e) : (console.log(t + "â†µ"), console.log(e)) } function o(e) { return d[e] } Object.defineProperty(t, "__esModule", { value: !0 }); var u = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), l = function () { function e() { n(this, e) } return u(e, null, [{ key: "error", value: function () { for (var t = arguments.length, i = Array(t), n = 0; n < t; n++)i[n] = arguments[n]; r(i, e.Levels.ERROR, "darkred") } }, { key: "warn", value: function () { for (var t = arguments.length, i = Array(t), n = 0; n < t; n++)i[n] = arguments[n]; r(i, e.Levels.WARNING, "darkorange") } }, { key: "notice", value: function () { for (var t = arguments.length, i = Array(t), n = 0; n < t; n++)i[n] = arguments[n]; r([].slice.call(arguments), e.Levels.NOTICE, "darkcyan") } }, { key: "debug", value: function () { for (var t = arguments.length, i = Array(t), n = 0; n < t; n++)i[n] = arguments[n]; r(i, e.Levels.DEBUG, "indigo") } }, { key: "debugCommonVideoEvents", value: function (t, i, n) { try { if (e.level <= e.Levels.DEBUG) { n = n || function (t) { e.debug("Event: " + t.type) }; var r = ["canplay", "buffering", "waiting", "ended", "play", "playing", "pause", "resume", "error", "abort", "seek", "seeking", "seeked", "stalled", "dispose", "loadeddata", "loadstart", "loadedmetadata"]; i && (null === i[0] ? (i.shift(), r = i) : r = r.concat(i)); for (var a = 0; a < r.length; a++)"function" == typeof t ? t.call(window, r[a], n) : t.on ? t.on(r[a], n) : t.addEventListener ? t.addEventListener(r[a], n) : t.addEventHandler ? t.addEventHandler(r[a], n) : e.warn("debugCommonVideoEvents: No common listener function found for ", t) } } catch (t) { e.warn(t) } } }]), e }(); l.Levels = { SILENT: 5, ERROR: 4, WARNING: 3, NOTICE: 2, DEBUG: 1, ALL: 0 }, l.level = l.Levels.ERROR, l.colorful = !0, l.includeTime = !0, l.prefix = "[nrvideo]"; var d = { 4: "e", 3: "w", 2: "n", 1: "d" }; !function () { if ("undefined" != typeof window && window.location && window.location.search) { var e = /\?.*&*nrvideo-debug=(.+)/i.exec(window.location.search); null !== e && ("true" === e[1] ? l.level = l.Levels.ALL : l.level = e[1]), null !== /\?.*&*nrvideo-colors=false/i.exec(window.location.search) && (l.colorful = !1) } }(), t.default = l }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), a = function () { function e() { n(this, e), this.reset() } return r(e, [{ key: "reset", value: function () { this.startTime = 0, this.stopTime = 0, this.offset = 0 } }, { key: "getDeltaTime", value: function () { return this.startTime ? this.offset + ((new Date).getTime() - this.startTime) : null } }, { key: "start", value: function () { this.startTime = (new Date).getTime(), this.stopTime = 0 } }, { key: "stop", value: function () { return this.stopTime = (new Date).getTime(), this.getDeltaTime() } }, { key: "clone", value: function () { var t = new e; return t.startTime = this.startTime, t.stopTime = this.stopTime, t.offset = this.offset, t } }]), e }(); t.default = a }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), a = function () { function e() { n(this, e) } return r(e, [{ key: "on", value: function (e, t) { if (this._listeners = this._listeners || {}, "function" == typeof t) return this._listeners[e] = this._listeners[e] || [], this._listeners[e].push(t), this } }, { key: "off", value: function (e, t) { if (this._listeners = this._listeners || {}, this._listeners[e]) { var i = this._listeners[e].indexOf(t); -1 !== i && this._listeners[e].splice(i, 1) } return this } }, { key: "emit", value: function (e, t) { var i = this; return this._listeners = this._listeners || {}, t = t || {}, Array.isArray(this._listeners[e]) && this._listeners[e].forEach(function (n) { n.call(i, { type: e, data: t, target: i }) }), Array.isArray(this._listeners["*"]) && this._listeners["*"].forEach(function (n) { n.call(i, { type: e, data: t, target: i }) }), this } }]), e }(); t.default = a }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } function r(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function a(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function s(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) } Object.defineProperty(t, "__esModule", { value: !0 }); var o = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), u = i(6), l = function (e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]); return t.default = e, t }(u), d = i(4), c = n(d), h = i(3), f = n(h), y = function (e) { function t(e) { r(this, t); var i = a(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)); return i.customData = {}, i.heartbeat = null, i.parentTracker = null, i._trackerReadyChrono = new f.default, i._trackerReadyChrono.start(), e = e || {}, i.setOptions(e), i } return s(t, e), o(t, [{ key: "setOptions", value: function (e) { e && (e.parentTracker && (this.parentTracker = e.parentTracker), e.customData && (this.customData = e.customData), e.heartbeat && (this.heartbeat = e.heartbeat)) } }, { key: "dispose", value: function () { this.unregisterListeners() } }, { key: "registerListeners", value: function () { } }, { key: "unregisterListeners", value: function () { } }, { key: "getHeartbeat", value: function () { return this.heartbeat ? this.heartbeat : this.parentTracker && this.parentTracker.heartbeat ? this.parentTracker.heartbeat : 3e4 } }, { key: "startHeartbeat", value: function () { this._heartbeatInterval = setInterval(this.sendHeartbeat.bind(this), Math.max(this.getHeartbeat(), 5e3)) } }, { key: "stopHeartbeat", value: function () { this._heartbeatInterval && clearInterval(this._heartbeatInterval) } }, { key: "sendHeartbeat", value: function (e) { this.send(t.Events.HEARTBEAT, e) } }, { key: "getAttributes", value: function (e) { e = e || {}, e.trackerName = this.getTrackerName(), e.trackerVersion = this.getTrackerVersion(), e.coreVersion = l.version, e.timeSinceTrackerReady = this._trackerReadyChrono.getDeltaTime(); for (var t in this.customData) e[t] = this.customData[t]; return e } }, { key: "getTrackerVersion", value: function () { return l.version } }, { key: "getTrackerName", value: function () { return "base-tracker" } }, { key: "send", value: function (e, t) { this.emit(e, this.getAttributes(t)) } }]), t }(c.default); y.Events = { HEARTBEAT: "HEARTBEAT" }, t.default = y }, function (e, t) { e.exports = { _from: "github:newrelic/video-core-js#v0.10.0", _id: "newrelic-video-core@0.10.0", _inBundle: !1, _location: "/newrelic-video-core", _phantomChildren: {}, _requested: { type: "git", raw: "github:newrelic/video-core-js#v0.10.0", rawSpec: "github:newrelic/video-core-js#v0.10.0", saveSpec: "github:newrelic/video-core-js#v0.10.0", fetchSpec: null, gitCommittish: "v0.10.0" }, _requiredBy: ["#USER", "/"], _resolved: "github:newrelic/video-core-js#5c39206664b1fa0a5647a2a9e9c5a9c326cca41c", _spec: "github:newrelic/video-core-js#v0.10.0", _where: "/Users/jaguilargorina/workspace/nrvideo/trackers/videojs", author: { name: "Jordi Aguilar" }, bugs: { url: "https://github.com/newrelic/video-core-js/issues" }, bundleDependencies: !1, dependencies: {}, deprecated: !1, description: "New Relic video tracking core library", devDependencies: { "aws-sdk": "^2.150.0", "babel-core": "^6.25.0", "babel-loader": "^7.1.1", "babel-preset-env": "^1.6.0", chai: "^4.1.0", "ink-docstrap": "^1.3.0", jsdoc: "^3.5.4", "jsdoc-babel": "^0.3.0", mocha: "^3.5.0", nyc: "^11.1.0", sinon: "^2.4.1", webpack: "^3.4.1" }, homepage: "https://github.com/newrelic/video-core-js#readme", license: "MIT", main: "src/index.js", name: "newrelic-video-core", repository: { type: "git", url: "git+https://github.com/newrelic/video-core-js.git" }, scripts: { build: "webpack -p", "build:dev": "webpack", clean: "rm -rf dist coverage doc", deploy: "node scripts/deploy.js", doc: "jsdoc -c jsdoc.json -d doc", test: "nyc --reporter=html --reporter=text mocha --compilers js:babel-core/register", watch: "webpack -p --progress --color --watch", "watch:dev": "webpack --progress --color --watch" }, version: "0.10.0" } }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), a = i(3), s = function (e) { return e && e.__esModule ? e : { default: e } }(a), o = function () { function e() { n(this, e), this.reset(), this._createdAt = Date.now() } return r(e, [{ key: "reset", value: function () { this._viewSession = null, this._viewCount = 0, this._isAd = !1, this.numberOfErrors = 0, this.numberOfAds = 0, this.numberOfVideos = 0, this.totalPlaytime = 0, this.resetFlags(), this.resetChronos() } }, { key: "resetFlags", value: function () { this.isPlayerReady = !1, this.isRequested = !1, this.isStarted = !1, this.isPaused = !1, this.isSeeking = !1, this.isBuffering = !1, this.isAdBreak = !1, this.isPlaying = !1 } }, { key: "resetChronos", value: function () { this.timeSinceRequested = new s.default, this.timeSinceStarted = new s.default, this.timeSincePaused = new s.default, this.timeSinceSeekBegin = new s.default, this.timeSinceBufferBegin = new s.default, this.timeSinceAdBreakStart = new s.default, this.timeSinceLastDownload = new s.default, this.timeSinceLastHeartbeat = new s.default, this.timeSinceLastRenditionChange = new s.default, this.timeSinceLastAdQuartile = new s.default, this.timeSinceLastAd = new s.default, this.playtimeSinceLastEvent = new s.default } }, { key: "isAd", value: function () { return this._isAd } }, { key: "setIsAd", value: function (e) { this._isAd = e } }, { key: "getViewSession", value: function () { if (!this._viewSession) { var e = (new Date).getTime(), t = Math.random().toString(36).substring(2) + Math.random().toString(36).substring(2); this._viewSession = e + "-" + t } return this._viewSession } }, { key: "getViewId", value: function () { return this.getViewSession() + "-" + this._viewCount } }, { key: "getStateAttributes", value: function (e) { return e = e || {}, this.isAd() ? (this.isRequested && (e.timeSinceAdRequested = this.timeSinceRequested.getDeltaTime(), e.timeSinceLastAdHeartbeat = this.timeSinceLastHeartbeat.getDeltaTime()), this.isStarted && (e.timeSinceAdStarted = this.timeSinceStarted.getDeltaTime()), this.isPaused && (e.timeSinceAdPaused = this.timeSincePaused.getDeltaTime()), this.isBuffering && (e.timeSinceAdBufferBegin = this.timeSinceBufferBegin.getDeltaTime()), this.isSeeking && (e.timeSinceAdSeekBegin = this.timeSinceSeekBegin.getDeltaTime()), this.isAdBreak && (e.timeSinceAdBreakBegin = this.timeSinceAdBreakStart.getDeltaTime()), e.numberOfAds = this.numberOfAds) : (this.isRequested && (e.timeSinceRequested = this.timeSinceRequested.getDeltaTime(), e.timeSinceLastHeartbeat = this.timeSinceLastHeartbeat.getDeltaTime()), this.isStarted && (e.timeSinceStarted = this.timeSinceStarted.getDeltaTime()), this.isPaused && (e.timeSincePaused = this.timeSincePaused.getDeltaTime()), this.isBuffering && (e.timeSinceBufferBegin = this.timeSinceBufferBegin.getDeltaTime()), this.isSeeking && (e.timeSinceSeekBegin = this.timeSinceSeekBegin.getDeltaTime()), e.timeSinceLastAd = this.timeSinceLastAd.getDeltaTime(), e.numberOfVideos = this.numberOfVideos), e.numberOfErrors = this.numberOfErrors, this.isAd() || (this.playtimeSinceLastEvent.startTime > 0 ? e.playtimeSinceLastEvent = this.playtimeSinceLastEvent.getDeltaTime() : e.playtimeSinceLastEvent = 0, this.isPlaying ? this.playtimeSinceLastEvent.start() : this.playtimeSinceLastEvent.reset(), this.totalPlaytime += e.playtimeSinceLastEvent, e.totalPlaytime = this.totalPlaytime), e } }, { key: "goViewCountUp", value: function () { this._viewCount++ } }, { key: "goPlayerReady", value: function () { return !this.isPlayerReady && (this.isPlayerReady = !0, !0) } }, { key: "goRequest", value: function () { return !this.isRequested && (this.isRequested = !0, this.timeSinceLastAd.reset(), this.timeSinceRequested.start(), !0) } }, { key: "goStart", value: function () { return !(!this.isRequested || this.isStarted) && (this.isAd() ? this.numberOfAds++ : this.numberOfVideos++, this.isStarted = !0, this.isPlaying = !0, this.timeSinceStarted.start(), this.playtimeSinceLastEvent.start(), !0) } }, { key: "goEnd", value: function () { return !!this.isRequested && (this.numberOfErrors = 0, this.isPlaying = !1, this.resetFlags(), this.timeSinceRequested.stop(), this.timeSinceStarted.stop(), this.playtimeSinceLastEvent.stop(), !0) } }, { key: "goPause", value: function () { return !(!this.isStarted || this.isPaused) && (this.isPaused = !0, this.isPlaying = !1, this.timeSincePaused.start(), this.playtimeSinceLastEvent.stop(), !0) } }, { key: "goResume", value: function () { return !(!this.isStarted || !this.isPaused) && (this.isPaused = !1, this.isPlaying = !0, this.timeSincePaused.stop(), !0) } }, { key: "goBufferStart", value: function () { return !(!this.isStarted || this.isBuffering) && (this.isBuffering = !0, this.isPlaying = !1, this.timeSinceBufferBegin.start(), !0) } }, { key: "goBufferEnd", value: function () { return !(!this.isStarted || !this.isBuffering) && (this.isBuffering = !1, this.isPlaying = !0, this.timeSinceBufferBegin.stop(), !0) } }, { key: "goSeekStart", value: function () { return !(!this.isStarted || this.isSeeking) && (this.isSeeking = !0, this.isPlaying = !1, this.timeSinceSeekBegin.start(), !0) } }, { key: "goSeekEnd", value: function () { return !(!this.isStarted || !this.isSeeking) && (this.isSeeking = !1, this.isPlaying = !0, this.timeSinceSeekBegin.stop(), !0) } }, { key: "goAdBreakStart", value: function () { return !this.isAdBreak && (this.isAdBreak = !0, this.timeSinceAdBreakStart.start(), !0) } }, { key: "goAdBreakEnd", value: function () { return !!this.isAdBreak && (this.isAdBreak = !1, this.timeSinceAdBreakStart.stop(), !0) } }, { key: "goDownload", value: function () { this.timeSinceLastDownload.start() } }, { key: "goHeartbeat", value: function () { this.timeSinceLastHeartbeat.start() } }, { key: "goRenditionChange", value: function () { this.timeSinceLastRenditionChange.start() } }, { key: "goAdQuartile", value: function () { this.timeSinceLastAdQuartile.start() } }, { key: "goError", value: function () { this.numberOfErrors++ } }, { key: "goLastAd", value: function () { this.timeSinceLastAd.start() } }]), e }(); t.default = o }, function (e, t) { e.exports = { name: "newrelic-video-videojs", version: "0.3.1", description: "New relic tracker for Videojs", main: "src/index.js", scripts: { build: "webpack -p", "build:dev": "webpack", watch: "webpack -p --progress --color --watch", "watch:dev": "webpack --progress --color --watch", prezip: "npm run build", zip: "zip -P newrelic -x '*.DS_Store' -x 'samples/agent.js' -r videojs.zip dist samples README.md CHANGELOG.md EULA.md", clean: "rm -rf dist *.zip", deploy: "node scripts/deploy.js" }, repository: { type: "git", url: "https://github.com/newrelic/video-videojs-js.git" }, author: "Jordi Aguilar", license: "MIT", dependencies: { "newrelic-video-core": "github:newrelic/video-core-js#v0.10.0" }, devDependencies: { "aws-sdk": "^2.157.0", "babel-core": "^6.25.0", "babel-loader": "^7.1.1", "babel-preset-env": "^1.6.0", "videojs-ima": "^0.6.0", webpack: "^3.4.1" } } }, function (e, t, i) { "use strict"; var n = i(0), r = function (e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]); return t.default = e, t }(n), a = i(13), s = function (e) { return e && e.__esModule ? e : { default: e } }(a); i(20), r.VideojsTracker = s.default, e.exports = r }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function r(e) { var t = a(e.data); u.default.level <= u.default.Levels.DEBUG ? u.default.notice("Sent", e.type, t) : u.default.notice("Sent", e.type), l.send(e.type, t) } function a(e) { var t = {}; for (var i in e) null !== e[i] && void 0 !== e[i] && (t[i] = e[i]); return t } Object.defineProperty(t, "__esModule", { value: !0 }); var s = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), o = i(2), u = function (e) { return e && e.__esModule ? e : { default: e } }(o), l = function () { function e() { n(this, e) } return s(e, null, [{ key: "addTracker", value: function (e) { e.on && e.emit ? (d.push(e), e.on("*", r)) : u.default.error("Tried to load a non-tracker.", e) } }, { key: "removeTracker", value: function (e) { e.off("*", r), e.dispose(); var t = d.indexOf(e); -1 !== t && d.splice(t, 1) } }, { key: "getTrackers", value: function () { return d } }, { key: "send", value: function (e, t) { "undefined" != typeof newrelic && newrelic.addPageAction ? newrelic.addPageAction(e, t) : c || (u.default.error("newrelic.addPageAction() is not available.", "In order to use NewRelic Video you will need New Relic Browser Agent."), c = !0) } }, { key: "sendError", value: function (t) { e.send("ERROR", t) } }]), e }(), d = [], c = !1; t.default = l }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(t, "__esModule", { value: !0 }); var r = function e() { n(this, e) }; r.AdPositions = { PRE: "pre", MID: "mid", POST: "post" }, t.default = r }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } function r(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function a(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function s(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) } function o(e) { this.send(e.type, e.data) } Object.defineProperty(t, "__esModule", { value: !0 }); var u = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), l = i(2), d = n(l), c = i(5), h = n(c), f = i(7), y = n(f), p = function (e) { function t(e, i) { r(this, t); var n = a(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)); return n.state = new y.default, n.adsTracker = null, i = i || {}, n.setOptions(i), e && n.setPlayer(e, i.tag), d.default.notice("Tracker " + n.getTrackerName() + " v" + n.getTrackerVersion() + " is ready."), n } return s(t, e), u(t, [{ key: "setOptions", value: function (e) { e && (e.adsTracker && this.setAdsTracker(e.adsTracker), "boolean" == typeof e.isAd && this.setIsAd(e.isAd), h.default.prototype.setOptions.apply(this, arguments)) } }, { key: "setPlayer", value: function (e, t) { (this.player || this.tag) && this.dispose(), "undefined" != typeof document && document.getElementById && ("string" == typeof e && (e = document.getElementById(e)), "string" == typeof t && (t = document.getElementById(t))), t = t || e, this.player = e, this.tag = t, this.registerListeners() } }, { key: "isAd", value: function () { return this.state.isAd() } }, { key: "setIsAd", value: function (e) { this.state.setIsAd(e) } }, { key: "setAdsTracker", value: function (e) { this.disposeAdsTracker(), e && (this.adsTracker = e, this.adsTracker.setIsAd(!0), this.adsTracker.parentTracker = this, this.adsTracker.on("*", o.bind(this))) } }, { key: "disposeAdsTracker", value: function () { this.adsTracker && (this.adsTracker.off("*", o), this.adsTracker.dispose()) } }, { key: "dispose", value: function () { this.stopHeartbeat(), this.disposeAdsTracker(), this.unregisterListeners(), this.player = null, this.tag = null } }, { key: "registerListeners", value: function () { } }, { key: "unregisterListeners", value: function () { } }, { key: "getViewId", value: function () { return this.parentTracker ? this.parentTracker.getViewId() : this.state.getViewId() } }, { key: "getViewSession", value: function () { return this.parentTracker ? this.parentTracker.getViewSession() : this.state.getViewSession() } }, { key: "getVideoId", value: function () { return null } }, { key: "getTitle", value: function () { return null } }, { key: "isLive", value: function () { return null } }, { key: "getBitrate", value: function () { return null } }, { key: "getWebkitBitrate", value: function () { if (this.tag && this.tag.webkitVideoDecodedByteCount) { var e = void 0; if (this._lastWebkitBitrate) { e = this.tag.webkitVideoDecodedByteCount; var t = e - this._lastWebkitBitrate, i = this.getHeartbeat() / 1e3; e = Math.round(t / i * 8) } return this._lastWebkitBitrate = this.tag.webkitVideoDecodedByteCount, e || null } } }, { key: "getRenditionName", value: function () { return null } }, { key: "getRenditionBitrate", value: function () { return null } }, { key: "getRenditionShift", value: function (e) { var t = this.getRenditionBitrate(), i = void 0; return this.isAd() ? (i = this._lastAdRendition, e && (this._lastAdRendition = t)) : (i = this._lastRendition, e && (this._lastRendition = t)), t && i ? t > i ? "up" : t < i ? "down" : null : null } }, { key: "getRenditionHeight", value: function () { return this.tag ? this.tag.videoHeight : null } }, { key: "getRenditionWidth", value: function () { return this.tag ? this.tag.videoWidth : null } }, { key: "getDuration", value: function () { return this.tag ? this.tag.duration : null } }, { key: "getPlayhead", value: function () { return this.tag ? this.tag.currentTime : null } }, { key: "getLanguage", value: function () { return null } }, { key: "getSrc", value: function () { return this.tag ? this.tag.currentSrc : null } }, { key: "getPlayrate", value: function () { return this.tag ? this.tag.playbackRate : null } }, { key: "isMuted", value: function () { return this.tag ? this.tag.muted : null } }, { key: "isFullscreen", value: function () { return null } }, { key: "getCdn", value: function () { return null } }, { key: "getPlayerName", value: function () { return this.getTrackerName() } }, { key: "getPlayerVersion", value: function () { return null } }, { key: "getFps", value: function () { return null } }, { key: "isAutoplayed", value: function () { return this.tag ? this.tag.autoplay : null } }, { key: "getPreload", value: function () { return this.tag ? this.tag.preload : null } }, { key: "getAdQuartile", value: function () { return null } }, { key: "getAdPosition", value: function () { return this.state.isStarted ? "pre" : "mid" } }, { key: "getAdPartner", value: function () { return null } }, { key: "getAdCreativeId", value: function () { return null } }, { key: "getAttributes", value: function (e) { e = h.default.prototype.getAttributes.apply(this, arguments), void 0 === e.isAd && (e.isAd = this.isAd()), e.viewSession = this.getViewSession(), e.viewId = this.getViewId(), e.playerName = this.getPlayerName(), e.playerVersion = this.getPlayerVersion(); try { e.pageUrl = window.location.href } catch (e) { } this.isAd() ? (e.adId = this.getVideoId(), e.adTitle = this.getTitle(), e.adBitrate = this.getBitrate() || this.getWebkitBitrate(), e.adRenditionName = this.getRenditionName(), e.adRenditionBitrate = this.getRenditionBitrate(), e.adRenditionHeight = this.getRenditionHeight(), e.adRenditionWidth = this.getRenditionWidth(), e.adDuration = this.getDuration(), e.adPlayhead = this.getPlayhead(), e.adLanguage = this.getLanguage(), e.adSrc = this.getSrc(), e.adCdn = this.getCdn(), e.adIsMuted = this.isMuted(), e.adFps = this.getFps(), e.adQuartile = this.getAdQuartile(), e.adPosition = this.getAdPosition(), e.adCreativeId = this.getAdCreativeId(), e.adPartner = this.getAdPartner()) : (e.contentId = this.getVideoId(), e.contentTitle = this.getTitle(), e.contentIsLive = this.isLive(), e.contentBitrate = this.getBitrate() || this.getWebkitBitrate(), e.contentRenditionName = this.getRenditionName(), e.contentRenditionBitrate = this.getRenditionBitrate(), e.contentRenditionHeight = this.getRenditionHeight(), e.contentRenditionWidth = this.getRenditionWidth(), e.contentDuration = this.getDuration(), e.contentPlayhead = this.getPlayhead(), e.contentLanguage = this.getLanguage(), e.contentSrc = this.getSrc(), e.contentPlayrate = this.getPlayrate(), e.contentIsFullscreen = this.isFullscreen(), e.contentIsMuted = this.isMuted(), e.contentCdn = this.getCdn(), e.contentIsAutoplayed = this.isAutoplayed(), e.contentPreload = this.getPreload(), e.contentFps = this.getFps()), this.state.getStateAttributes(e); for (var t in this.customData) e[t] = this.customData[t]; return e } }, { key: "sendPlayerReady", value: function (e) { this.state.goPlayerReady() && (e = e || {}, this.send(t.Events.PLAYER_READY, e)) } }, { key: "sendRequest", value: function (e) { if (this.state.goRequest()) { this.state.goViewCountUp(); var i = this.isAd() ? t.Events.AD_REQUEST : t.Events.CONTENT_REQUEST; this.send(i, e), this.startHeartbeat(), this.state.goHeartbeat() } } }, { key: "sendStart", value: function (e) { if (this.state.goStart()) { var i = void 0; this.isAd() ? (i = t.Events.AD_START, this.parentTracker && (this.parentTracker.state.isPlaying = !1)) : i = t.Events.CONTENT_START, this.send(i, e) } } }, { key: "sendEnd", value: function (e) { if (this.state.goEnd()) { e = e || {}; var i = void 0; this.isAd() ? (i = t.Events.AD_END, e.timeSinceAdRequested = this.state.timeSinceRequested.getDeltaTime(), e.timeSinceAdStarted = this.state.timeSinceStarted.getDeltaTime(), this.parentTracker && (this.parentTracker.state.isPlaying = !0)) : (i = t.Events.CONTENT_END, e.timeSinceRequested = this.state.timeSinceRequested.getDeltaTime(), e.timeSinceStarted = this.state.timeSinceStarted.getDeltaTime()), this.stopHeartbeat(), this.send(i, e), this.parentTracker && this.isAd() && this.parentTracker.state.goLastAd(), this.state.goViewCountUp() } } }, { key: "sendPause", value: function (e) { if (this.state.goPause()) { var i = this.isAd() ? t.Events.AD_PAUSE : t.Events.CONTENT_PAUSE; this.send(i, e) } } }, { key: "sendResume", value: function (e) { if (this.state.goResume()) { e = e || {}; var i = void 0; this.isAd() ? (i = t.Events.AD_RESUME, e.timeSinceAdPaused = this.state.timeSincePaused.getDeltaTime()) : (i = t.Events.CONTENT_RESUME, e.timeSincePaused = this.state.timeSincePaused.getDeltaTime()), this.send(i, e) } } }, { key: "sendBufferStart", value: function (e) { if (this.state.goBufferStart()) { var i = void 0; i = this.isAd() ? t.Events.AD_BUFFER_START : t.Events.CONTENT_BUFFER_START, this.send(i, e) } } }, { key: "sendBufferEnd", value: function (e) { if (this.state.goBufferEnd()) { e = e || {}; var i = void 0; this.isAd() ? (i = t.Events.AD_BUFFER_END, e.timeSinceAdBufferBegin = this.state.timeSinceBufferBegin.getDeltaTime()) : (i = t.Events.CONTENT_BUFFER_END, e.timeSinceBufferBegin = this.state.timeSinceBufferBegin.getDeltaTime()), this.send(i, e) } } }, { key: "sendSeekStart", value: function (e) { if (this.state.goSeekStart()) { var i = void 0; i = this.isAd() ? t.Events.AD_SEEK_START : t.Events.CONTENT_SEEK_START, this.send(i, e) } } }, { key: "sendSeekEnd", value: function (e) { if (this.state.goSeekEnd()) { e = e || {}; var i = void 0; this.isAd() ? (i = t.Events.AD_SEEK_END, e.timeSinceAdSeekBegin = this.state.timeSinceSeekBegin.getDeltaTime()) : (i = t.Events.CONTENT_SEEK_END, e.timeSinceSeekBegin = this.state.timeSinceSeekBegin.getDeltaTime()), this.send(i, e) } } }, { key: "sendDownload", value: function (e) { e = e || {}, e.state || d.default.warn("Called sendDownload without { state: xxxxx }."), this.send(t.Events.DOWNLOAD, e), this.state.goDownload() } }, { key: "sendError", value: function (e) { e = e || {}, e.isAd = !0, this.state.goError(); var i = this.isAd() ? t.Events.AD_ERROR : t.Events.CONTENT_ERROR; this.send(i, e) } }, { key: "sendRenditionChanged", value: function (e) { e = e || {}, e.timeSinceLastRenditionChange = this.state.timeSinceLastRenditionChange.getDeltaTime(), e.shift = this.getRenditionShift(!0); var i = void 0; i = this.isAd() ? t.Events.AD_RENDITION_CHANGE : t.Events.CONTENT_RENDITION_CHANGE, this.send(i, e), this.state.goRenditionChange() } }, { key: "sendHeartbeat", value: function (e) { if (this.state.isRequested) { var i = void 0; i = this.isAd() ? t.Events.AD_HEARTBEAT : t.Events.CONTENT_HEARTBEAT, this.send(i, e), this.state.goHeartbeat() } } }, { key: "sendAdBreakStart", value: function (e) { this.isAd() && this.state.goAdBreakStart() && this.send(t.Events.AD_BREAK_START, e) } }, { key: "sendAdBreakEnd", value: function (e) { this.isAd() && this.state.goAdBreakEnd() && (e = e || {}, e.timeSinceAdBreakBegin = this.state.timeSinceAdBreakStart.getDeltaTime(), this.send(t.Events.AD_BREAK_END, e)) } }, { key: "sendAdQuartile", value: function (e) { this.isAd() && (e = e || {}, e.quartile || d.default.warn("Called sendAdQuartile without { quartile: xxxxx }."), e.timeSinceLastAdQuartile = this.state.timeSinceLastAdQuartile.getDeltaTime(), this.send(t.Events.AD_QUARTILE, e), this.state.goAdQuartile()) } }, { key: "sendAdClick", value: function (e) { this.isAd() && (e = e || {}, e.url || d.default.warn("Called sendAdClick without { url: xxxxx }."), this.send(t.Events.AD_CLICK, e)) } }]), t }(h.default); p.Events = { PLAYER_READY: "PLAYER_READY", DOWNLOAD: "DOWNLOAD", ERROR: "ERROR", CONTENT_REQUEST: "CONTENT_REQUEST", CONTENT_START: "CONTENT_START", CONTENT_END: "CONTENT_END", CONTENT_PAUSE: "CONTENT_PAUSE", CONTENT_RESUME: "CONTENT_RESUME", CONTENT_SEEK_START: "CONTENT_SEEK_START", CONTENT_SEEK_END: "CONTENT_SEEK_END", CONTENT_BUFFER_START: "CONTENT_BUFFER_START", CONTENT_BUFFER_END: "CONTENT_BUFFER_END", CONTENT_HEARTBEAT: "CONTENT_HEARTBEAT", CONTENT_RENDITION_CHANGE: "CONTENT_RENDITION_CHANGE", CONTENT_ERROR: "CONTENT_ERROR", AD_REQUEST: "AD_REQUEST", AD_START: "AD_START", AD_END: "AD_END", AD_PAUSE: "AD_PAUSE", AD_RESUME: "AD_RESUME", AD_SEEK_START: "AD_SEEK_START", AD_SEEK_END: "AD_SEEK_END", AD_BUFFER_START: "AD_BUFFER_START", AD_BUFFER_END: "AD_BUFFER_END", AD_HEARTBEAT: "AD_HEARTBEAT", AD_RENDITION_CHANGE: "AD_RENDITION_CHANGE", AD_ERROR: "AD_ERROR", AD_BREAK_START: "AD_BREAK_START", AD_BREAK_END: "AD_BREAK_END", AD_QUARTILE: "AD_QUARTILE", AD_CLICK: "AD_CLICK" }, t.default = p }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } function r(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function a(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function s(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) } Object.defineProperty(t, "__esModule", { value: !0 }), t.FreewheelAdsTracker = t.BrightcoveImaAdsTracker = t.ImaAdsTracker = t.VideojsAdsTracker = t.ShakaTech = t.ContribHlsTech = t.HlsJsTech = void 0; var o = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), u = i(0), l = function (e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]); return t.default = e, t }(u), d = i(8), c = i(14), h = n(c), f = i(15), y = n(f), p = i(16), v = n(p), g = i(1), k = n(g), m = i(17), E = n(m), T = i(18), b = n(T), A = i(19), S = n(A), _ = function (e) { function t() { return r(this, t), a(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments)) } return s(t, e), o(t, [{ key: "getTech", value: function () { var e = this.player.tech({ IWillNotUseThisInPlugins: !0 }); if (e) { if (h.default.isUsing(e)) return new h.default(e); if (y.default.isUsing(e)) return new y.default(e); if (v.default.isUsing(e)) return new v.default(e) } } }, { key: "getTrackerName", value: function () { return "videojs" } }, { key: "getTrackerVersion", value: function () { return d.version } }, { key: "getPlayhead", value: function () { return this.player.ads && "ads-playback" === this.player.ads.state && this.player.ads.snapshot && this.player.ads.snapshot.currentTime ? 1e3 * this.player.ads.snapshot.currentTime : this.player.absoluteTime ? 1e3 * this.player.absoluteTime() : 1e3 * this.player.currentTime() } }, { key: "getDuration", value: function () { return this.player.mediainfo && void 0 !== this.player.mediainfo.duration ? 1e3 * this.player.mediainfo.duration : 1e3 * this.player.duration() } }, { key: "getTitle", value: function () { if (this.player.mediainfo) return this.player.mediainfo.name } }, { key: "getSrc", value: function () { var e = this.getTech(); return e && e.getSrc ? e.getSrc() : this.player.currentSrc() } }, { key: "getPlayerVersion", value: function () { return videojs.VERSION } }, { key: "isMuted", value: function () { return this.player.muted() } }, { key: "getRenditionName", value: function () { var e = this.getTech(); if (e && e.getRenditionName) return e.getRenditionName() } }, { key: "getRenditionBitrate", value: function () { var e = this.getTech(); if (e && e.getRenditionBitrate) return e.getRenditionBitrate() } }, { key: "getRenditionHeight", value: function () { var e = this.getTech(); return e && e.getRenditionHeight ? e.getRenditionHeight() : this.player.videoHeight() } }, { key: "getRenditionWidth", value: function () { var e = this.getTech(); return e && e.getRenditionWidth ? e.getRenditionWidth() : this.player.videoWidth() } }, { key: "getPlayrate", value: function () { return this.player.playbackRate() } }, { key: "isAutoplayed", value: function () { return this.player.autoplay() } }, { key: "getPreload", value: function () { return this.player.preload() } }, { key: "registerListeners", value: function () { l.Log.debugCommonVideoEvents(this.player, ["adstart", "adend", "adskip", "adsready", "adserror", "dispose"]), this.player.on("loadstart", this.onDownload.bind(this)), this.player.on("loadeddata", this.onDownload.bind(this)), this.player.on("loadedmetadata", this.onDownload.bind(this)), this.player.on("adsready", this.onAdsready.bind(this)), this.player.on("play", this.onPlay.bind(this)), this.player.on("pause", this.onPause.bind(this)), this.player.on("playing", this.onPlaying.bind(this)), this.player.on("abort", this.onAbort.bind(this)), this.player.on("ended", this.onEnded.bind(this)), this.player.on("dispose", this.onDispose.bind(this)), this.player.on("seeking", this.onSeeking.bind(this)), this.player.on("seeked", this.onSeeked.bind(this)), this.player.on("error", this.onError.bind(this)), this.player.on("waiting", this.onWaiting.bind(this)), this.player.on("timeupdate", this.onTimeupdate.bind(this)) } }, { key: "unregisterListeners", value: function () { this.player.off("loadstart", this.onDownload), this.player.off("loadeddata", this.onDownload), this.player.off("loadedmetadata", this.onDownload), this.player.off("adsready", this.onAdsready), this.player.off("play", this.onPlay), this.player.off("pause", this.onPause), this.player.off("playing", this.onPlaying), this.player.off("abort", this.onAbort), this.player.off("ended", this.onEnded), this.player.off("dispose", this.onDispose), this.player.off("seeking", this.onSeeking), this.player.off("seeked", this.onSeeked), this.player.off("error", this.onError), this.player.off("waiting", this.onWaiting), this.player.off("timeupdate", this.onTimeupdate) } }, { key: "onDownload", value: function (e) { this.sendDownload({ state: e.type }) } }, { key: "onAdsready", value: function () { this.adsTracker || (b.default.isUsing(this.player) ? this.setAdsTracker(new b.default(this.player)) : E.default.isUsing(this.player) ? this.setAdsTracker(new E.default(this.player)) : S.default.isUsing(this.player) ? this.setAdsTracker(new S.default(this.player)) : this.setAdsTracker(new k.default(this.player))) } }, { key: "onPlay", value: function () { this.sendRequest() } }, { key: "onPause", value: function () { this.sendPause() } }, { key: "onPlaying", value: function () { this.sendResume(), this.sendBufferEnd() } }, { key: "onAbort", value: function () { this.sendEnd() } }, { key: "onEnded", value: function () { this.sendEnd() } }, { key: "onDispose", value: function () { this.sendEnd() } }, { key: "onSeeking", value: function () { this.sendSeekStart() } }, { key: "onSeeked", value: function () { this.sendSeekEnd() } }, { key: "onError", value: function () { this.player.error && this.player.error() && this.sendError(this.player.error()) } }, { key: "onWaiting", value: function (e) { this.sendBufferStart() } }, { key: "onTimeupdate", value: function (e) { this.getPlayhead() > .1 && this.sendStart() } }]), t }(l.VideoTracker); t.default = _, t.HlsJsTech = y.default, t.ContribHlsTech = h.default, t.ShakaTech = v.default, t.VideojsAdsTracker = k.default, t.ImaAdsTracker = E.default, t.BrightcoveImaAdsTracker = b.default, t.FreewheelAdsTracker = S.default }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), a = function () { function e(t) { n(this, e), this.tech = t.hls } return r(e, [{ key: "getRenditionName", value: function () { try { var e = this.tech.playlists.media(); if (e && e.attributes) return e.attributes.NAME } catch (e) { } return null } }, { key: "getRenditionBitrate", value: function () { try { var e = this.tech.playlists.media(); if (e && e.attributes) return e.attributes.BANDWIDTH } catch (e) { } return null } }, { key: "getRenditionWidth", value: function () { try { var e = this.tech.playlists.media(); if (e && e.attributes && e.attributes.RESOLUTION) return e.attributes.RESOLUTION.width } catch (e) { } return null } }, { key: "getRenditionHeight", value: function () { try { var e = this.tech.playlists.media(); if (e && e.attributes && e.attributes.RESOLUTION) return e.attributes.RESOLUTION.height } catch (e) { } return null } }]), e }(); t.default = a, a.isUsing = function (e) { return !!e.hls } }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), a = function () { function e(t) { n(this, e), this.tech = t.hls_ } return r(e, [{ key: "getResource", value: function (e) { return this.tech.url } }, { key: "getRenditionName", value: function (e) { try { var t = this.tech.levels[this.tech.currentLevel]; if (t && t.name) return t.name } catch (e) { } return null } }, { key: "getRenditionBitrate", value: function (e) { try { var t = this.tech.levels[this.tech.currentLevel]; if (t && t.bitrate) return t.bitrate } catch (e) { } return null } }, { key: "getRenditionWidth", value: function (e) { try { var t = this.tech.levels[this.tech.currentLevel]; if (t && t.width) return t.width } catch (e) { } return null } }, { key: "getRenditionHeight", value: function (e) { try { var t = this.tech.levels[this.tech.currentLevel]; if (t && t.height) return t.height } catch (e) { } return null } }]), e }(); t.default = a, a.isUsing = function (e) { return !!e.hls_ } }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), a = function () { function e(t) { n(this, e), this.tech = t.shakaPlayer } return r(e, [{ key: "getSrc", value: function (e) { try { return this.tech.getManifestUri() } catch (e) { } return null } }, { key: "getRenditionBitrate", value: function (e) { try { return this.tech.getStats().streamBandwidth } catch (e) { } return null } }, { key: "getRenditionWidth", value: function (e) { try { var t = this.tech.getVariantTracks(); for (var i in t) { var n = t[i]; if (n.active && "video" === n.type) return n.width } } catch (e) { } return null } }, { key: "getRenditionHeight", value: function (e) { try { var t = this.tech.getVariantTracks(); for (var i in t) { var n = t[i]; if (n.active && "video" === n.type) return n.height } } catch (e) { } return null } }]), e }(); t.default = a, a.isUsing = function (e) { return !!e.shakaPlayer } }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function r(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function a(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) } Object.defineProperty(t, "__esModule", { value: !0 }); var s = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), o = i(0), u = function (e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]); return t.default = e, t }(o), l = i(1), d = function (e) { return e && e.__esModule ? e : { default: e } }(l), c = function (e) { function t() { return n(this, t), r(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments)) } return a(t, e), s(t, [{ key: "getTrackerName", value: function () { return "ima-ads" } }, { key: "getPlayerName", value: function () { return "ima" } }, { key: "getPlayerVersion", value: function () { return "ima: " + google.ima.VERSION + "; contrib-ads: " + this.player.ads.VERSION } }, { key: "getDuration", value: function () { try { return 1e3 * this.player.ima.getAdsManager().getCurrentAd().getDuration() } catch (e) { } } }, { key: "getVideoId", value: function () { try { return this.player.ima.getAdsManager().getCurrentAd().getAdId() } catch (e) { } } }, { key: "getAdCreativeId", value: function () { try { return this.player.ima.getAdsManager().getCurrentAd().getCreativeId() } catch (e) { } } }, { key: "getSrc", value: function () { try { return this.player.ima.getAdsManager().getCurrentAd().getMediaUrl() } catch (e) { } } }, { key: "getTitle", value: function () { try { return this.player.ima.getAdsManager().getCurrentAd().getTitle() } catch (e) { } } }, { key: "getPlayhead", value: function () { var e = this.player.ima.getAdsManager(); if (e) return 1e3 * (this.getDuration() - e.getRemainingTime()) } }, { key: "getPlayrate", value: function () { return this.player.playbackRate() } }, { key: "getAdPartner", value: function () { return "ima" } }, { key: "registerListeners", value: function () { var e = google.ima.AdEvent.Type, t = google.ima.AdErrorEvent.Type.AD_ERROR; u.Log.debugCommonVideoEvents(this.player.ima.addEventListener, [null, e.ALL_ADS_COMPLETED, e.LINEAR_CHANGED, e.COMPLETE, e.USER_CLOSE, e.IMPRESSION, e.CONTENT_PAUSE_REQUESTED, e.CONTENT_RESUME_REQUESTED, e.SKIPPED, e.SKIPPABLE_STATE_CHANGED, e.LOADED, e.PAUSED, e.RESUMED, e.STARTED, e.AD_CAN_PLAY, e.AD_METADATA, e.EXPANDED_CHANGED, e.AD_BREAK_READY, e.LOG, e.CLICK, e.FIRST_QUARTILE, e.MIDPOINT, e.THIRD_QUARTILE, t]), this.player.ima.addEventListener(e.LOADED, this.onLoaded.bind(this)), this.player.ima.addEventListener(e.IMPRESSION, this.onImpression.bind(this)), this.player.ima.addEventListener(e.PAUSED, this.onPaused.bind(this)), this.player.ima.addEventListener(e.RESUMED, this.onResumed.bind(this)), this.player.ima.addEventListener(e.COMPLETE, this.onComplete.bind(this)), this.player.ima.addEventListener(e.SKIPPED, this.onSkipped.bind(this)), this.player.ima.addEventListener(e.CLICK, this.onClick.bind(this)), this.player.ima.addEventListener(e.FIRST_QUARTILE, this.onFirstQuartile.bind(this)), this.player.ima.addEventListener(e.MIDPOINT, this.onMidpoint.bind(this)), this.player.ima.addEventListener(e.THIRD_QUARTILE, this.onThirdQuartile.bind(this)), this.player.ima.addEventListener(t, this.onError.bind(this)), this.player.on("adend", this.onAdend.bind(this)) } }, { key: "unregisterListeners", value: function () { var e = google.ima.AdEvent.Type, t = google.ima.AdErrorEvent.Type.AD_ERROR; this.player.ima.removeEventListener(e.LOADED, this.onLoaded), this.player.ima.removeEventListener(e.IMPRESSION, this.onImpression), this.player.ima.removeEventListener(e.PAUSED, this.onPaused), this.player.ima.removeEventListener(e.RESUMED, this.onResumed), this.player.ima.removeEventListener(e.COMPLETE, this.onComplete), this.player.ima.removeEventListener(e.SKIPPED, this.onSkipped), this.player.ima.removeEventListener(e.CLICK, this.onClick), this.player.ima.removeEventListener(e.FIRST_QUARTILE, this.onFirstQuartile), this.player.ima.removeEventListener(e.MIDPOINT, this.onMidpoint), this.player.ima.removeEventListener(e.THIRD_QUARTILE, this.onThirdQuartile), this.player.ima.removeEventListener(t, this.onError), this.player.off("adend", this.onAdend) } }, { key: "onLoaded", value: function (e) { this.sendRequest() } }, { key: "onImpression", value: function (e) { this.sendStart() } }, { key: "onComplete", value: function (e) { this.sendEnd() } }, { key: "onAdend", value: function (e) { this.sendEnd() } }, { key: "onSkipped", value: function (e) { this.sendEnd({ skipped: !0 }) } }, { key: "onError", value: function (e) { this.sendError(e.getError()) } }, { key: "onClick", value: function (e) { this.sendAdClick() } }, { key: "onFirstQuartile", value: function () { this.sendAdQuartile({ quartile: 1 }) } }, { key: "onMidpoint", value: function () { this.sendAdQuartile({ quartile: 2 }) } }, { key: "onThirdQuartile", value: function () { this.sendAdQuartile({ quartile: 3 }) } }, { key: "onPaused", value: function () { this.sendPause() } }, { key: "onResumed", value: function () { this.sendResume() } }], [{ key: "isUsing", value: function (e) { return e.ima && "undefined" != typeof google } }]), t }(d.default); t.default = c }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function r(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function a(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) } Object.defineProperty(t, "__esModule", { value: !0 }); var s = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), o = i(0), u = function (e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]); return t.default = e, t }(o), l = i(1), d = function (e) { return e && e.__esModule ? e : { default: e } }(l), c = function (e) { function t() { return n(this, t), r(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments)) } return a(t, e), s(t, [{ key: "getTrackerName", value: function () { return "brightcove-ima-ads" } }, { key: "getPlayerName", value: function () { return "brightcove-ima-ads" } }, { key: "getPlayhead", value: function () { return this.player.ima3.adPlayer.currentTime() } }, { key: "registerListeners", value: function () { u.Log.debugCommonVideoEvents(this.player, [null, "ima3-ready", "ima3error", "ima3-ad-error", "ima3-started", "ima3-complete", "ima3-paused", "ima3-resumed", "ads-request", "ads-load", "ads-ad-started", "ads-ad-ended", "ads-pause", "ads-play", "ads-click", "ads-pod-started", "ads-pod-ended", "ads-allpods-completed"]), this.player.on("ima3-started", this.onStarted.bind(this)), this.player.on("ima3-paused", this.onPaused.bind(this)), this.player.on("ima3-resumed", this.onResume.bind(this)), this.player.on("ima3-complete", this.onComplete.bind(this)), this.player.on("ima3-skipped", this.onSkipped.bind(this)), this.player.on("adserror", this.onError.bind(this)), this.player.on("ads-click", this.onClick.bind(this)) } }, { key: "unregisterListeners", value: function () { this.player.off("ima3-started", this.onStarted), this.player.off("ima3-paused", this.onPaused), this.player.off("ima3-resumed", this.onResume), this.player.off("ima3-complete", this.onComplete), this.player.off("ima3-skipped", this.onSkipped), this.player.off("adserror", this.onError), this.player.off("ads-click", this.onClick) } }, { key: "onStarted", value: function (e) { this.sendRequest(), this.sendStart() } }, { key: "onPaused", value: function (e) { this.sendPause() } }, { key: "onResume", value: function (e) { this.sendResume() } }, { key: "onComplete", value: function (e) { this.sendEnd() } }, { key: "onSkipped", value: function (e) { this.sendEnd({ skipped: !0 }) } }, { key: "onError", value: function (e) { this.sendError() } }, { key: "onClick", value: function (e) { this.sendClick() } }], [{ key: "isUsing", value: function (e) { return !!e.ima3 } }]), t }(d.default); t.default = c }, function (e, t, i) { "use strict"; function n(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function r(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function a(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) } Object.defineProperty(t, "__esModule", { value: !0 }); var s = function () { function e(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (t, i, n) { return i && e(t.prototype, i), n && e(t, n), t } }(), o = i(1), u = function (e) { return e && e.__esModule ? e : { default: e } }(o), l = function (e) { function t() { return n(this, t), r(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments)) } return a(t, e), s(t, [{ key: "getTrackerName", value: function () { return "freewheel-ads" } }, { key: "getPlayerName", value: function () { return "freewheel-ads" } }, { key: "getPlayerVersion", value: function () { return this.player.FreeWheelPlugin.VERSION } }, { key: "getPlayhead", value: function () { if (this.player.ads.ad.currentTime) return 1e3 * this.player.ads.ad.currentTime() } }, { key: "getDuration", value: function () { if (this.player.ads.ad.duration) return 1e3 * this.player.ads.ad.duration } }, { key: "getVideoId", value: function () { return this.player.ads.ad.id } }, { key: "getAdPartner", value: function () { return "freewheel" } }, { key: "getAdCreativeId", value: function () { try { return this.player.ads.provider.event.adInstance.getActiveCreativeRendition().getId() } catch (e) { } } }, { key: "getSrc", value: function () { try { return this.player.ads.provider.event.adInstance.getActiveCreativeRendition().getPrimaryCreativeRenditionAsset().getUrl() } catch (e) { } } }, { key: "getTitle", value: function () { try { return this.player.ads.provider.event.adInstance.getActiveCreativeRendition().getPrimaryCreativeRenditionAsset().getName() } catch (e) { } } }, { key: "getAdPosition", value: function () { switch (this.player.ads.ad.type) { case "PREROLL": return nrvideo.Constants.AdPositions.PRE; case "MIDROLL": return nrvideo.Constants.AdPositions.MID; case "POSTROLL": return nrvideo.Constants.AdPositions.POST } } }], [{ key: "isUsing", value: function (e) { return !!e.FreeWheelPlugin && "undefined" != typeof tv && tv.freewheel } }]), t }(u.default); t.default = l }, function (e, t, i) { "use strict"; if ("undefined" != typeof videojs) { (videojs.registerPlugin || videojs.plugin)("newrelic", function (e) { return this.newrelictracker || (this.newrelictracker = new nrvideo.VideojsTracker(this), nrvideo.Core.addTracker(this.newrelictracker)), this.newrelictracker }) } }]) });
//# sourceMappingURL=newrelic-video-videojs.min.js.maps